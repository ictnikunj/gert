{# Gathering media #}
{% set formElementsMediaIds = [] %}
{% set formElementsValueCount = 0 %}
{% for formElement in formElements %}
    {% if formElement.value %}
        {% set formElementsValueCount = formElementsValueCount + 1 %}
        {% if formElement.type == 'upload' %}
            {% set formElementsMediaIds = formElementsMediaIds|merge([formElement.value]) %}
        {% endif %}
    {% endif %}
{% endfor %}
{% set mediaCollection = searchMedia(formElementsMediaIds, context.context) %}

{% if formElementsValueCount == 0 %}
    <div role="alert" class="alert alert-warning alert-has-icon">
        {% sw_icon 'warning' %}
        <div class="alert-content-container">
            <div class="alert-content">
                {{ "moorl-form-builder.general.parametersMissing"|trans }}
            </div>
        </div>
    </div>
{% else %}
    <table class="table table-striped table-sm" style="table-layout: fixed;">
        {% for formElement in formElements %}
            {% if formElement.value %}
                {% set formElementLabel = formElement.translated.label %}

                <tr>
                    <th>
                        {{ formElementLabel }}:
                    </th>
                    <td>
                        {% if formElement.type == 'datepicker' %}
                            {{ formElement.value|format_date('long', locale=app.request.locale) }}
                        {% elseif formElement.type == 'appointment' %}
                            {{ formElement.value|format_datetime('long', locale=app.request.locale) }}
                        {% elseif formElement.type == 'upload' %}
                            {% set formElementMedia = mediaCollection.get(formElement.value) %}
                            {% if formElementMedia %}
                                <a href="{{ formElementMedia.url }}" download="{{ formElementMedia.fileName|slice(33) }}.{{ formElementMedia.fileExtension }}">
                                    {% if formElementMedia.fileExtension in ['png','jpg','jpeg','gif'] %}
                                        <img style="max-width: 100%; max-height: 100px" alt="{{ formElementMedia.fileName }}" src="{{ formElementMedia.url }}">
                                    {% else %}
                                        {{ formElementMedia.fileName|slice(33) }}.{{ formElementMedia.fileExtension }}
                                    {% endif %}
                                </a>
                            {% endif %}
                        {% else %}
                            {% if formElement.type in ['select','multiselect','radio-group','checkbox-group'] %}
                                {% for option in formElement.options %}
                                    {% if option.value == formElement.value or option.value in formElement.value %}
                                        {{ option.translated.label }}
                                        {% sw_include "@MoorlFormBuilder/plugin/moorl-form-builder/component/price-label.html.twig" ignore missing %}
                                        <br>
                                    {% endif %}
                                {% endfor %}
                            {% else %}
                                {{ formElement.value|nl2br }}
                            {% endif %}
                        {% endif %}
                    </td>
                </tr>
            {% endif %}
        {% endfor %}
    </table>
{% endif %}
