(window.webpackJsonp=window.webpackJsonp||[]).push([["sisi-search"],{"8Yoi":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return h}));var r=n("FGIj"),i=n("k8s9");function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?u(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=function(t){function n(){var e,t;a(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return p(u(t=c(this,(e=l(n)).call.apply(e,[this].concat(i)))),"pro",[]),p(u(t),"url",""),t}var r,o,h;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(n,t),r=n,(o=[{key:"init",value:function(){this._registerEventListeners(),this._client=new i.a}},{key:"_registerEventListeners",value:function(){this.el.addEventListener("click",this._closePopup.bind(this)),this._submitManfature(),this._submitCategories(),this._submitproperties(),this._scrollPoupUp(),this._setFilterInfo(),this._resetFilter(),this._chanceForm(),this._setSuggestText()}},{key:"_setSuggestText",value:function(){var t=this;e(this.el).on("click",".sisi-suggest-text",(function(){var n=e(this).html();n=n.trim(),e(".header-search-input").val(n);var r=t._mergeUrl(n,"","","");t.fetch(r,"","","")}))}},{key:"_scrollPoupUp",value:function(){var e=this;document.addEventListener("scroll",(function(t){if("sisi-search-suggest-container-right"===t.target.id)for(var n=document.querySelectorAll(".sisi-last-row"),r=0;r<n.length;r++)e.isInViewport(n[r])&&e.loadProduct()}),!0)}},{key:"loadProduct",value:function(){var t=this,n=e(".header-search-input").val(),r=(r=e(".header-search-form").data("url"))+n,i=e("#sisi-search-suggest-container"),o=i.data("from"),a=i.data("max"),s=i.data("size"),c=i.data("ma");void 0!==c&&""!==c&&(r+="&ma="+c),""!==o&&void 0!==o||(i.data("from",1),o=1),a>(o+1)*s&&(r+="&p="+ ++o,t._client.get(r,(function(n){e("#sisi-search-suggest-container").data("from",o);var r=e(n).find("#sisi-search-suggest-container-right ul").html();e(t.el).find("#sisi-search-suggest-container-right ul").append(r)})))}},{key:"isInViewport",value:function(e){var t=e.getBoundingClientRect();return!e.classList.contains("sisiIsvisible")&&t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)&&(e.classList.add("sisiIsvisible"),!0)}},{key:"_chanceForm",value:function(){var t=this;e("body").on("input",".header-search-input",(function(){t.pro=[]}))}},{key:"_resetFilter",value:function(){var t=this;e(this.el).on("click",".sisi-resetFilter",(function(){var n=e(".header-search-input").val(),r=t._mergeUrl(n,"","","");return t.fetch(r,"","",""),t.pro=[],!1}))}},{key:"_submitCategories",value:function(){var t=this;e(this.el).on("click",".sisi-categories",(function(){var n=e("#sisi-search-suggest-container"),r=e(this).data("categories");r=t._replace_and(r);var i=e(".header-search-input").val(),o=n.data("ma");o=t._replace_and(o);var a=n.data("pro");a=t._replace_and(a);var s=t._mergeUrl(i,r,o,a);return t.fetch(s,r,o,a),!1}))}},{key:"_submitManfature",value:function(){var t=this;e(this.el).on("click",".sisi-manufacturer",(function(){var n=e("#sisi-search-suggest-container"),r=e(this).data("manufacturer");r=t._replace_and(r);var i=e(".header-search-input").val(),o=n.data("cat");o=t._replace_and(o);var a=n.data("pro");a=t._replace_and(a);var s=t._mergeUrl(i,o,r,a);return t.fetch(s,o,r,a),!1}))}},{key:"_submitproperties",value:function(){var t=this;e(this.el).on("click",".sisi-properties",(function(){var n=e("#sisi-search-suggest-container");t.pro.push(e(this).data("properties"));var r=e(".header-search-input").val(),i=n.data("cat"),o=n.data("ma"),a=t._mergeUrl(r,i,o,t.pro);return t.fetch(a,i,o,t.pro),!1}))}},{key:"_replace_and",value:function(e){return e.toString().replace("&","")}},{key:"_setFilterInfo",value:function(t,n,r){var i=0;if(""!==t&&void 0!==t&&0!=t&&i++,""!==n&&void 0!==n&&0!=n&&i++,""!==r&&void 0!==r&&0!=r)for(var o=0;o<r.length;o++)""!==r[o]&&void 0!==r[o]&&0!=r[o]&&i++;i>0&&e(".sisi-resetFilter").append(i)}},{key:"_closePopup",value:function(t){e(this.el).on("click",".sisi-search-suggest-container-close-inner",(function(){e("#sisi-search-suggest-container").css({display:"none"})}))}},{key:"_mergeUrl",value:function(t,n,r,i){var o=e(".header-search-form").data("url");if(o+=t,""!==t&&""!==n&&void 0!==n&&0!=n&&(o+="&cat="+n),""!==t&&""!==r&&void 0!==r&&0!=r&&(o+="&ma="+r),""!==i&&void 0!==i&&0!=i)for(var a=0;a<i.length;a++)""!==i[a]&&void 0!==i[a]&&0!==i[a]&&(o+="&pro["+a+"]="+i[a]);return o}},{key:"fetch",value:function(t,n,r,i){var o=this;this._client.get(t,(function(t){e(".search-suggest").html(t),o._setFilterInfo(n,r,i)}))}}])&&s(r.prototype,o),h&&s(r,h),n}(r.a);p(h,"options",{})}).call(this,n("UoTJ"))},a6mF:function(e,t,n){"use strict";n.r(t);var r=n("8Yoi");function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u,f,p,h=function(e){function t(){return o(this,t),s(this,c(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,e),n=t,(r=[{key:"init",value:function(){this._registerEventListeners()}},{key:"_registerEventListeners",value:function(){this.el.addEventListener("click",this._paging.bind(this))}},{key:"_paging",value:function(e){if("sisi-page-input"===e.target.classList[1]){var t=e.target.defaultValue,n=e.target.baseURI;n=(n=n.replace(/(\&p=)([0-9]+)/g,""))+"&p="+t,location.href=n}}}])&&a(n.prototype,r),i&&a(n,i),t}(n("FGIj").a);p={},(f="options")in(u=h)?Object.defineProperty(u,f,{value:p,enumerable:!0,configurable:!0,writable:!0}):u[f]=p;var d=n("kJ0o"),v=window.PluginManager;v.register("ClosePopup",r.a,".header-main"),v.register("Paging",h,"body"),v.register("Filter",d.a,".sisiFilter")},kJ0o:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return d}));var r=n("FGIj"),i=n("ERap"),o=(n("gHbT"),n("k8s9"));function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?f(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=function(t){function n(){var e,t;s(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return h(f(t=l(this,(e=u(n)).call.apply(e,[this].concat(i)))),"pro",[]),h(f(t),"ma",[]),h(f(t),"filterName",[]),h(f(t),"maName",[]),h(f(t),"p",0),h(f(t),"count",0),h(f(t),"hits",0),h(f(t),"resetText",""),h(f(t),"merker",[]),t}var r,a,d;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(n,t),r=n,(a=[{key:"init",value:function(){this._registerEvents(),this._client=new o.a}},{key:"_registerEvents",value:function(){var t=e(".filter-multi-select-checkbox"),n=this;e(this.el).on("change",t,(function(e){n._onChangeFilter(),n.p=1})),this._onResetFilter(),this._onResetAllFilter(),this._scrollPoupUp()}},{key:"_onResetAllFilter",value:function(){var t=this;e(this.el).on("click",".filter-reset-all",(function(){var n=e(".filter-multi-select-properties .filter-multi-select-checkbox:checked"),r=e(".filter-multi-select-manufacturer .filter-multi-select-checkbox:checked");n.each((function(t){e(this).prop("checked",!1)})),r.each((function(t){e(this).prop("checked",!1)})),t._onChangeFilter(),t.p=0,t.filterName=[],t.maName=[]}))}},{key:"_onResetFilter",value:function(){var t=this;e(this.el).on("click",".filter-active-remove",(function(){var n=e(this).data("id");e("#"+n).prop("checked",!1),t._onChangeFilter(),t.p=0}))}},{key:"_onChangeFilter",value:function(){var t=e(".filter-multi-select-properties .filter-multi-select-checkbox:checked"),n=e(".filter-multi-select-manufacturer .filter-multi-select-checkbox:checked"),r=this;this.pro=[],this.p=1,r.filterName=[],r.maName=[],t.each((function(t){var n=e(this).attr("id");if(!r.pro.includes(n)&&void 0!==n){r.pro.push(n);var i=e(this).parent().parent().find("label").html();r.filterName.push(i)}})),this.ma=[],n.each((function(t){var n=e(this).attr("id");if(!r.ma.includes(n)&&void 0!==n){r.ma.push(n);var i=e(this).parent().parent().find("label").html();r.maName.push(i)}})),r.p=0,r.merker=[],this.fetch(!1)}},{key:"_scrollPoupUp",value:function(){var t=this;"yes"===e(".search-headline").data("scrolling")&&document.addEventListener("scroll",(function(e){for(var n=document.querySelectorAll(".sisi-last-row"),r=0;r<n.length;r++)t.isInViewport(n[r])&&(0===t.p&&t.p++,1===t.p&&t.p++,-1===t.merker.indexOf(t.p)&&t.p>1&&(t.merker.push(t.p),t.fetch(!0)))}),!0)}},{key:"_get_p",value:function(){var e={};return window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,(function(t,n,r){e[n]=r})),e.p}},{key:"isInViewport",value:function(e){var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight+200||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)&&(e.classList.add("sisiIsvisible"),!0)}},{key:"_setFilter",value:function(t,n){var r="",i=e(".search-headline").data("reset");return e.each(t,(function(e,t){r=r+'<span class="filter-active"> '+t+'<button class="filter-active-remove" data-id="'+n[e]+'"> ×</button></span>'})),t.length>0&&(r=r+'<button class="filter-reset-all btn btn-sm btn-outline-danger">'+i+"</button>"),r}},{key:"_IterateFilter",value:function(e){var t=0,n=0,r=[];return i.a.iterate(this.pro,(function(n){e=e+"&pro["+t+"]="+n,r[t]=n,t++})),i.a.iterate(this.ma,(function(i){e=e+"&ma["+n+"]="+i,r[t]=i,n++,t++})),[r,e]}},{key:"fetch",value:function(t){var n=this,r=this,i=e(".search-headline").data("ajax"),o="?search="+e(".header-search-input").val(),a=[],s=[],c=r.filterName.concat(r.maName);i+=o,t&&(i=i+"&p="+r.p);var l=r._IterateFilter(i);s=l[0],i=l[1];var u=e(".cms-listing-row .product-box").length;if(r.count>u||0===r.count||!1===t){a=r._setFilter(c,s);var f=e("#filter-panel-wrapper").html();e(".row.cms-listing-row").append('<div class="cms-listing-col col-xl-12 sisi-listing-loder"><div class="loader" role="status"style="display: inline-block; margin-left: 49%"><span class="sr-only">Loading...</span></div></div>'),this._client.get(i,(function(t){var o=e(t).find(".cms-listing-row").html(),l=e(t).find(".search-headline"),u=l.html(),p=l.data("count"),h=n.pro.concat(n.ma),d=l.data("last");r.p>1?e(".cms-listing-row").append(o):(e(".cms-listing-row").html(o),f=e(t).find("#filter-panel-wrapper").html()),e(".search-headline").html(u).attr("data-count",p).attr("data-last",d),e(".pagination-nav").html(""),e("#filter-panel-wrapper").html(f),s=[],e(".filter-multi-select-checkbox").each((function(t){var n=e(this).val();h.includes(n)&&e(this).prop("checked",!0)})),r.p++;var v=r._IterateFilter(i);s=v[0],i=v[1],a=r._setFilter(c,s),e(".sisi-listing-loder").remove(),e(".filter-panel-active-container").html(a),r.count=p;var m=e(".cms-listing-row .cms-listing-col"),g=m.length;m.each((function(t){e(this).removeClass("sisi-last-row"),t===g-1&&e(this).addClass("sisi-last-row")}))}))}}}])&&c(r.prototype,a),d&&c(r,d),n}(r.a)}).call(this,n("UoTJ"))}},[["a6mF","runtime","vendor-node","vendor-shared"]]]);